{"remainingRequest":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\src\\views\\Ranking.vue?vue&type=script&lang=js&","dependencies":[{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\src\\views\\Ranking.vue","mtime":1578729348000},{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgSGVhZHNob3QgZnJvbSAiLi4vY29tcG9uZW50cy9oZWFkc2hvdCI7DQppbXBvcnQgYm9va3NMaXN0IGZyb20gIi4uL2NvbXBvbmVudHMvYm9va3NMaXN0IjsNCmltcG9ydCBWdWUgZnJvbSAidnVlIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdGl0bGU6ICLmjpLooYzmppwiLA0KICAgICAgYWN0aXZlOiAwLA0KICAgICAgYWN0aXZlS2V5OiAwLA0KICAgICAgbWFuOiBbXSwNCiAgICAgIG52OiBbXSwNCiAgICAgIGNodWJhbjogW10sDQogICAgICBjdXJyZW50QXJyOiBbXSwNCiAgICAgIGN1cnJlbnRBcnIyOiBbXQ0KICAgIH07DQogIH0sDQogIGNvbXBvbmVudHM6IHsNCiAgICBIZWFkc2hvdCwNCiAgICBib29rc0xpc3QNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHRhYnNDbGlja0ZuKGluZGV4LCB0aXRsZSkgew0KICAgICAgd2luZG93LmNvbnNvbGUubG9nKHRpdGxlLCBpbmRleCk7DQogICAgICBpZiAoaW5kZXggPT09IDApIHsNCiAgICAgICAgLy8g55S355Sf5Li66buY6K6k6L+b5YWl5pe26YCJ5LitLOaJgOS7peivt+axguaVsOaNruW6lOivpeaUvuWcqGNyZWF0ZWQNCiAgICAgICAgLy8g55S355SfLOagueaNrueUt+eUn+eahOaVsOaNruaVsOe7hOmHjOmdoueahGlk5Y+36I635Y+W5ZCE5Liq5qac55qE5o6S5ZCNDQogICAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAxKSB7DQogICAgICAgIC8vIOWls+eUnw0KICAgICAgfSBlbHNlIGlmIChpbmRleCA9PT0gMikgew0KICAgICAgICAvLyDlh7rniYgNCiAgICAgIH0NCiAgICB9LA0KICAgIG9uY2hhbmdlKGluZGV4KSB7DQogICAgICB3aW5kb3cuY29uc29sZS5sb2codGhpcy5jdXJyZW50QXJyW2luZGV4XS5ib29rcyk7DQogICAgICB0aGlzLmN1cnJlbnRBcnIyID0gdGhpcy5jdXJyZW50QXJyW2luZGV4XS5ib29rczsNCiAgICB9LA0KICAgIGlzZGVmYXV0KHZtKSB7DQogICAgICAvLyDpu5jorqTmmL7npLrnlLfnlJ/mqKHlnZcs5omA5Lul5YWI5Y+W55S355Sf5pWw5o2uDQogICAgICB3aW5kb3cuY29uc29sZS5sb2codm0ubWFuKTsNCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdm0ubWFuLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIFZ1ZS5heGlvcw0KICAgICAgICAgIC5nZXQoImh0dHA6Ly9ub3ZlbC5rZWxlOC5jbi9yYW5rLyIgKyB2bS5tYW5baV0uX2lkKQ0KICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgIHZtLmN1cnJlbnRBcnIuc3BsaWNlKGksIDAsIHJlc3BvbnNlLmRhdGEucmFua2luZyk7DQogICAgICAgICAgICBpZiAoaSA9PT0gMCkgew0KICAgICAgICAgICAgICB2bS5jdXJyZW50QXJyMiA9IHZtLmN1cnJlbnRBcnJbaV0uYm9va3M7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSk7DQogICAgICB9DQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIC8vICAg5o6S6KGM5qac57uE5Lu2DQogICAgLy8gMS4wIOeUt+mikeOAgeWls+mikeOAgeWHuueJiOWQhOiHquivt+axguiHquW3seeahHh45qac55qE5pWw5o2uDQogICAgLy8NCiAgICAvLyAxLjEg5YiH5o2i5LqL5Lu26Kem5Y+R5pe25bCx6I635Y+W77yM6I635Y+W5ZCO5a2Y5YWl5pys5Zyw57yT5a2YDQogICAgLy8gMS4yIOS4i+asoeWIh+aNouaXtuWImeivu+WPluacrOWcsOe8k+WtmO+8jOmCo+S5iOWtmOS5puexjeaVsOaNrui/mOaYr3h45qac55qEaWTlj7cNCiAgICAvLw0KICAgIC8vIDIuMCDlho3moLnmja7mr4/kuKrmppznmoRpZOWPt+iOt+WPluS5puexjeaVsOaNrg0KICAgIC8vIGNyZWF0ZWTov5nph4znmoTku6PnoIHmr5Tnu4Tku7blrojljavliY3nva7ov5jml6nmiafooYwNCiAgfSwNCiAgLy8gICDnu4Tku7blrojljavvvIzmnKznu4Tku7booqvmuLLmn5PmiJbosIPnlKjliY3miafooYzov5nph4znmoTku6PnoIENCiAgLy8g5rOo5oSP5Zyo57uE5Lu25Yib5bu65YmN6L+Q6KGM77yM5oSP5ZGz552A57uE5Lu25rKh6KKr5Yib5bu677yM5omA5LuldGhpc+S4jeWtmOWcqA0KICBiZWZvcmVSb3V0ZUVudGVyKHRvLCBmcm9tLCBuZXh0KSB7DQogICAgdmFyIFNlYXJjaCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oIlNlYXJjaCIpKTsNCiAgICAvLyAgIOi/memHjOaXoOazleS9v+eUqHRoaXMs6K+35rGC5LiJ5aSn5qih5Z2X55qE5pWw5o2uLOi/memHjOWKoOWIpOaWreWPr+S7peiuvue9ruaYr+WQpue8k+WtmA0KICAgIGlmIChTZWFyY2guUmFua2luZykgew0KICAgICAgLy8g5bey57yT5a2Y55qE5oOF5Ya1DQogICAgICBuZXh0KHZtID0+IHsNCiAgICAgICAgdm0ubWFuID0gU2VhcmNoLlJhbmtpbmcubWFuOw0KICAgICAgICB2bS5udiA9IFNlYXJjaC5SYW5raW5nLm52Ow0KICAgICAgICB2bS5jaHViYW4gPSBTZWFyY2guUmFua2luZy5jaHViYW47DQogICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygi6K+75Y+W57yT5a2YIik7DQogICAgICAgIHZtLmlzZGVmYXV0KHZtKTsNCiAgICAgIH0pOw0KICAgIH0gZWxzZSB7DQogICAgICAvLyDnrKzkuIDmrKHojrflj5bmlbDmja4NCiAgICAgIHZhciBvYmogPSB7fTsNCg0KICAgICAgVnVlLmF4aW9zLmdldCgiaHR0cDovL25vdmVsLmtlbGU4LmNuL3JhbmstY2F0ZWdvcnkiKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKHJlc3BvbnNlKTsNCiAgICAgICAgLy8g5b+F6aG76KaB6L+Q6KGMbmV4dOWHveaVsA0KICAgICAgICBuZXh0KHZtID0+IHsNCiAgICAgICAgICAvLyDkuInlpKfmqKHlnZfnmoTlkITkuKp4eOamnA0KICAgICAgICAgIHZtLm1hbiA9IHJlc3BvbnNlLmRhdGEubWFsZTsNCiAgICAgICAgICB2bS5udiA9IHJlc3BvbnNlLmRhdGEuZmVtYWxlOw0KICAgICAgICAgIHZtLmNodWJhbiA9IHJlc3BvbnNlLmRhdGEuZXB1YjsNCg0KICAgICAgICAgIG9iai5tYW4gPSByZXNwb25zZS5kYXRhLm1hbGU7DQogICAgICAgICAgb2JqLm52ID0gcmVzcG9uc2UuZGF0YS5mZW1hbGU7DQogICAgICAgICAgb2JqLmNodWJhbiA9IHJlc3BvbnNlLmRhdGEuZXB1YjsNCiAgICAgICAgICBTZWFyY2guUmFua2luZyA9IG9iajsNCiAgICAgICAgICAvLyDmm7TmlrDmnKzlnLANCiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiU2VhcmNoIiwgSlNPTi5zdHJpbmdpZnkoU2VhcmNoKSk7DQogICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCLmlbDmja7ojrflj5blrozmiJAiKTsNCg0KICAgICAgICAgIHZtLmlzZGVmYXV0KCk7DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["Ranking.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Ranking.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"ranking\">\r\n    <!-- 头部 -->\r\n    <Headshot :title=\"title\" />\r\n    <!-- 一级水平分类 -->\r\n    <div class=\"justify\">\r\n      <van-tabs v-model=\"active\" @click=\"tabsClickFn\">\r\n        <van-tab title=\"男频\">\r\n          <!-- 二级左边垂直分类 -->\r\n          <div class=\"zhanwei\">\r\n            <div></div>\r\n          </div>\r\n          <van-sidebar v-model=\"activeKey\" @change=\"onchange\">\r\n            <van-sidebar-item v-for=\"(item, index) in currentArr\" :key=\"index\" :title=\"item.title\" />\r\n            <!-- <van-sidebar-item title=\"最热榜\" />\r\n            <van-sidebar-item title=\"潜力榜\" />\r\n            <van-sidebar-item title=\"飙升榜\" />\r\n            <van-sidebar-item title=\"热搜榜\" />\r\n            <van-sidebar-item title=\"完结榜\" />\r\n            <van-sidebar-item title=\"好评榜\" />\r\n            <van-sidebar-item title=\"VIP榜\" />\r\n            <van-sidebar-item title=\"留存榜\" />\r\n            <van-sidebar-item title=\"免费榜\" />-->\r\n\r\n            <!-- 右边排行榜数据列表 -->\r\n          </van-sidebar>\r\n          <div class=\"right\">\r\n            <div class=\"right-box\">\r\n              <booksList\r\n                v-for=\"(item, index) in currentArr2\"\r\n                :key=\"index\"\r\n                :book=\"item\"\r\n                :index=\"index\"\r\n                :type=\"'排行榜'\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </van-tab>\r\n        <van-tab title=\"女频\">\r\n          <!-- 二级左边垂直分类 -->\r\n          <van-sidebar v-model=\"activeKey\">\r\n            <van-sidebar-item title=\"畅销榜\" />\r\n            <van-sidebar-item title=\"最热榜\" />\r\n            <van-sidebar-item title=\"潜力榜\" />\r\n            <van-sidebar-item title=\"飙升榜\" />\r\n            <van-sidebar-item title=\"热搜榜\" />\r\n            <van-sidebar-item title=\"完结榜\" />\r\n            <van-sidebar-item title=\"好评榜\" />\r\n            <van-sidebar-item title=\"VIP榜\" />\r\n            <van-sidebar-item title=\"留存榜\" />\r\n            <van-sidebar-item title=\"免费榜\" />\r\n          </van-sidebar>\r\n        </van-tab>\r\n        <van-tab title=\"出版\">\r\n          <!-- 二级左边垂直分类 -->\r\n          <van-sidebar v-model=\"activeKey\">\r\n            <van-sidebar-item title=\"飙升榜\" />\r\n            <van-sidebar-item title=\"VIP榜\" />\r\n            <van-sidebar-item title=\"热搜榜\" />\r\n            <van-sidebar-item title=\"免费榜\" />\r\n          </van-sidebar>\r\n        </van-tab>\r\n      </van-tabs>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Headshot from \"../components/headshot\";\r\nimport booksList from \"../components/booksList\";\r\nimport Vue from \"vue\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      title: \"排行榜\",\r\n      active: 0,\r\n      activeKey: 0,\r\n      man: [],\r\n      nv: [],\r\n      chuban: [],\r\n      currentArr: [],\r\n      currentArr2: []\r\n    };\r\n  },\r\n  components: {\r\n    Headshot,\r\n    booksList\r\n  },\r\n  methods: {\r\n    tabsClickFn(index, title) {\r\n      window.console.log(title, index);\r\n      if (index === 0) {\r\n        // 男生为默认进入时选中,所以请求数据应该放在created\r\n        // 男生,根据男生的数据数组里面的id号获取各个榜的排名\r\n      } else if (index === 1) {\r\n        // 女生\r\n      } else if (index === 2) {\r\n        // 出版\r\n      }\r\n    },\r\n    onchange(index) {\r\n      window.console.log(this.currentArr[index].books);\r\n      this.currentArr2 = this.currentArr[index].books;\r\n    },\r\n    isdefaut(vm) {\r\n      // 默认显示男生模块,所以先取男生数据\r\n      window.console.log(vm.man);\r\n      for (let i = 0; i < vm.man.length; i++) {\r\n        Vue.axios\r\n          .get(\"http://novel.kele8.cn/rank/\" + vm.man[i]._id)\r\n          .then(response => {\r\n            vm.currentArr.splice(i, 0, response.data.ranking);\r\n            if (i === 0) {\r\n              vm.currentArr2 = vm.currentArr[i].books;\r\n            }\r\n          });\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    //   排行榜组件\r\n    // 1.0 男频、女频、出版各自请求自己的xx榜的数据\r\n    //\r\n    // 1.1 切换事件触发时就获取，获取后存入本地缓存\r\n    // 1.2 下次切换时则读取本地缓存，那么存书籍数据还是xx榜的id号\r\n    //\r\n    // 2.0 再根据每个榜的id号获取书籍数据\r\n    // created这里的代码比组件守卫前置还早执行\r\n  },\r\n  //   组件守卫，本组件被渲染或调用前执行这里的代码\r\n  // 注意在组件创建前运行，意味着组件没被创建，所以this不存在\r\n  beforeRouteEnter(to, from, next) {\r\n    var Search = JSON.parse(localStorage.getItem(\"Search\"));\r\n    //   这里无法使用this,请求三大模块的数据,这里加判断可以设置是否缓存\r\n    if (Search.Ranking) {\r\n      // 已缓存的情况\r\n      next(vm => {\r\n        vm.man = Search.Ranking.man;\r\n        vm.nv = Search.Ranking.nv;\r\n        vm.chuban = Search.Ranking.chuban;\r\n        window.console.log(\"读取缓存\");\r\n        vm.isdefaut(vm);\r\n      });\r\n    } else {\r\n      // 第一次获取数据\r\n      var obj = {};\r\n\r\n      Vue.axios.get(\"http://novel.kele8.cn/rank-category\").then(response => {\r\n        window.console.log(response);\r\n        // 必须要运行next函数\r\n        next(vm => {\r\n          // 三大模块的各个xx榜\r\n          vm.man = response.data.male;\r\n          vm.nv = response.data.female;\r\n          vm.chuban = response.data.epub;\r\n\r\n          obj.man = response.data.male;\r\n          obj.nv = response.data.female;\r\n          obj.chuban = response.data.epub;\r\n          Search.Ranking = obj;\r\n          // 更新本地\r\n          localStorage.setItem(\"Search\", JSON.stringify(Search));\r\n          window.console.log(\"数据获取完成\");\r\n\r\n          vm.isdefaut();\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.ranking {\r\n  .justify {\r\n    width: 100%;\r\n    position: fixed;\r\n    top: 1.17333rem;\r\n    left: 0;\r\n    .van-tab__pane {\r\n      display: flex;\r\n      flex-flow: row;\r\n      .zhanwei {\r\n        min-width: 85px;\r\n        height: 100%;\r\n      }\r\n      .van-sidebar {\r\n        position: fixed;\r\n        overflow-y: scroll;\r\n        overflow-x: hidden;\r\n\r\n        // 要设置top和bottom才会发生滚动条\r\n        top: 81px;\r\n        bottom: 0;\r\n      }\r\n\r\n      .right {\r\n        flex-grow: 1;\r\n        .right-box {\r\n          width: 235px;\r\n          // 设置了绝对定位flex-grow会失效\r\n          position: fixed;\r\n          left: 85px;\r\n          top: 81px;\r\n          bottom: 0;\r\n          overflow-y: scroll;\r\n          overflow-x: hidden;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"]}]}