{"remainingRequest":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\src\\views\\xiangqingye.vue?vue&type=script&lang=js&","dependencies":[{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\src\\views\\xiangqingye.vue","mtime":1580640992000},{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"H:\\1962VUE-cil-router\\vueAPp\\fictionapp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgVnVlIGZyb20gInZ1ZSI7DQppbXBvcnQgaGVhZHNob3QgZnJvbSAiLi4vY29tcG9uZW50cy9oZWFkc2hvdCI7DQppbXBvcnQgY29tbWVudCBmcm9tICIuLi9jb21wb25lbnRzL2NvbW1lbnQiOw0KaW1wb3J0IGludGVyZXN0TGlzdCBmcm9tICIuLi9jb21wb25lbnRzL2ludGVyZXN0TGlzdCI7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIG5hbWU6ICLkuabnsY3or6bmg4UiLA0KICAgICAgYWN0aXZlTmFtZTogIjEiLA0KICAgICAgZGF0YToge30sDQogICAgICBwaW5sdW46IFtdLA0KICAgICAgcmVsYXRlOiBbXQ0KICAgIH07DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgY292ZXIoKSB7DQogICAgICAvLyDliqDkuIpzbGljZe+8jOaYr+S4uuS6huWOu+aOieWktOmDqOeahC9hZ2VudC8NCiAgICAgIHJldHVybiB3aW5kb3cudW5lc2NhcGUodGhpcy5kYXRhLmNvdmVyKS5zbGljZSg3KTsNCiAgICB9LA0KICAgIHdvcmRDb3VudCgpIHsNCiAgICAgIHJldHVybiB0aGlzLmRhdGEud29yZENvdW50ID4gOTk5OQ0KICAgICAgICA/ICh0aGlzLmRhdGEud29yZENvdW50IC8gMTAwMDApLnRvRml4ZWQoMSkgKyAi5LiHIg0KICAgICAgICA6IHRoaXMuZGF0YS53b3JkQ291bnQ7DQogICAgfSwNCiAgICB1cGRhdGVBbmRwcm9ncmVzcygpIHsNCiAgICAgIHJldHVybiAoDQogICAgICAgIHRoaXMuZm9ybWF0aW5nKERhdGUubm93KCkgLSBEYXRlLnBhcnNlKHRoaXMuZGF0YS51cGRhdGVkKSwgdHJ1ZSkgKw0KICAgICAgICB0aGlzLmRhdGEubGFzdENoYXB0ZXINCiAgICAgICk7DQogICAgfQ0KICB9LA0KICBjb21wb25lbnRzOiB7DQogICAgaGVhZHNob3QsDQogICAgY29tbWVudCwNCiAgICBpbnRlcmVzdExpc3QNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICAvLyDor7fmsYLor4TorroNCiAgICBWdWUuYXhpb3MNCiAgICAgIC5nZXQoImh0dHA6Ly9ub3ZlbC5rZWxlOC5jbi9ib29rL3Jldmlld3M/Ym9vaz0iICsgdGhpcy4kcm91dGUucXVlcnkuaWQpDQogICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cocmVzKTsNCg0KICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cocmVzLmRhdGEucmV2aWV3cy5zbGljZSgwLCAyKSk7DQogICAgICAgIHRoaXMucGlubHVuID0gcmVzLmRhdGEucmV2aWV3cy5zbGljZSgwLCAyKTsNCiAgICAgIH0pOw0KICAgIC8vIOivt+axguebuOWFs+aOqOiNkA0KICAgIFZ1ZS5heGlvcw0KICAgICAgLmdldCgiaHR0cDovL25vdmVsLmtlbGU4LmNuL3JlY29tbWVuZC8iICsgdGhpcy4kcm91dGUucXVlcnkuaWQpDQogICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgdGhpcy5yZWxhdGUgPSByZXMuZGF0YS5ib29rcy5zbGljZSgwLCA0KTsNCiAgICAgIH0pOw0KICB9LA0KICBiZWZvcmVSb3V0ZUVudGVyKHRvLCBmcm9tLCBuZXh0KSB7DQogICAgLy8g6K+35rGC5Lmm57GN5L+h5oGvDQogICAgVnVlLmF4aW9zDQogICAgICAuZ2V0KCJodHRwOi8vbm92ZWwua2VsZTguY24vYm9vay1pbmZvLyIgKyB0by5xdWVyeS5pZCkNCiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKHJlc3BvbnNlKTsNCiAgICAgICAgbmV4dCh2bSA9PiB7DQogICAgICAgICAgdm0uZGF0YSA9IHJlc3BvbnNlLmRhdGE7DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBmb3JtYXRpbmcoc3RyLCBrdW9oYW8pIHsNCiAgICAgIHZhciBtaWFvID0gc3RyIC8gMTAwMDsNCiAgICAgIHZhciBmZW4gPSBtaWFvIC8gNjA7DQogICAgICB2YXIgeGlhb3NoaSA9IGZlbiAvIDYwOw0KICAgICAgaWYgKGt1b2hhbykgew0KICAgICAgICBpZiAoeGlhb3NoaSA+PSAxKSB7DQogICAgICAgICAgcmV0dXJuICJbIiArIHBhcnNlSW50KHhpYW9zaGkpICsgIuWwj+aXtuWJjeabtOaWsF0gIjsNCiAgICAgICAgfSBlbHNlIGlmIChmZW4gPj0gMSkgew0KICAgICAgICAgIHJldHVybiAiWyIgKyBwYXJzZUludChmZW4pICsgIuWIhumSn+WJjeabtOaWsF0gIjsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgaWYgKHhpYW9zaGkgPj0gMSkgew0KICAgICAgICAgIHJldHVybiBwYXJzZUludCh4aWFvc2hpKSArICLlsI/ml7bliY3mm7TmlrAiOw0KICAgICAgICB9IGVsc2UgaWYgKGZlbiA+PSAxKSB7DQogICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGZlbikgKyAi5YiG6ZKf5YmN5pu05pawIjsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["xiangqingye.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"xiangqingye.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"xiangqingye\">\r\n    <headshot class=\"head\" :title=\"name\" />\r\n    <section class=\"shuxinxi\">\r\n      <div class=\"shuxinxi_wrapper\">\r\n        <div class=\"left\">\r\n          <img :src=\"cover\" alt />\r\n        </div>\r\n        <div class=\"right\">\r\n          <h4>{{data.title}}</h4>\r\n          <div>\r\n            <span>{{data.author}}</span>\r\n            <span>|</span>\r\n            <span>{{data.cat}}</span>\r\n            <span>|</span>\r\n            <span>{{wordCount}}</span>\r\n          </div>\r\n          <span>{{formating(Date.now() - Date.parse(this.data.updated), false)? formating(Date.now() - Date.parse(this.data.updated, false)): '完结'}}</span>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section class=\"anniu\">\r\n      <div class=\"btn-wrapper\">\r\n        <div class=\"left\">加入书架</div>\r\n        <div class=\"right\">开始阅读</div>\r\n      </div>\r\n    </section>\r\n    <section class=\"renqi\">\r\n      <div class=\"item\">\r\n        <p>追人气</p>\r\n        <span>{{data.chaptersCount}}</span>\r\n      </div>\r\n      <div class=\"item\">\r\n        <p>读者留存率</p>\r\n        <span>{{data.retentionRatio}}%</span>\r\n      </div>\r\n      <div class=\"item\">\r\n        <p>日更字数/天</p>\r\n        <span>{{data.serializeWordCount}}</span>\r\n      </div>\r\n    </section>\r\n    <section class=\"juqing\">\r\n      <div class=\"text\">{{data.longIntro}}</div>\r\n      <div class=\"jiantou\"></div>\r\n    </section>\r\n    <section class=\"mulu\">\r\n      <div class=\"mulu-box\">\r\n        目录\r\n        <div class=\"right\">{{updateAndprogress}}</div>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- 热门书评 -->\r\n    <section class=\"remenshupin\">\r\n      <div class=\"pinlun\">\r\n        <div class=\"title\">热门书评</div>\r\n        <comment v-for=\"(item, index) in pinlun\" :key=\"index\" :obj=\"item\" />\r\n      </div>\r\n    </section>\r\n\r\n    <!-- 无评论时显示 -->\r\n    <section class=\"lingpinlun\"></section>\r\n\r\n    <!-- 相关推荐 -->\r\n    <section class=\"relate\">\r\n      <interestList :obj=\"relate\" />\r\n    </section>\r\n\r\n    <!-- 版权声明 -->\r\n    <section class=\"banquan\"></section>\r\n\r\n    <!-- 底部 -->\r\n    <section class=\"footer\"></section>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from \"vue\";\r\nimport headshot from \"../components/headshot\";\r\nimport comment from \"../components/comment\";\r\nimport interestList from \"../components/interestList\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      name: \"书籍详情\",\r\n      activeName: \"1\",\r\n      data: {},\r\n      pinlun: [],\r\n      relate: []\r\n    };\r\n  },\r\n  computed: {\r\n    cover() {\r\n      // 加上slice，是为了去掉头部的/agent/\r\n      return window.unescape(this.data.cover).slice(7);\r\n    },\r\n    wordCount() {\r\n      return this.data.wordCount > 9999\r\n        ? (this.data.wordCount / 10000).toFixed(1) + \"万\"\r\n        : this.data.wordCount;\r\n    },\r\n    updateAndprogress() {\r\n      return (\r\n        this.formating(Date.now() - Date.parse(this.data.updated), true) +\r\n        this.data.lastChapter\r\n      );\r\n    }\r\n  },\r\n  components: {\r\n    headshot,\r\n    comment,\r\n    interestList\r\n  },\r\n  created() {\r\n    // 请求评论\r\n    Vue.axios\r\n      .get(\"http://novel.kele8.cn/book/reviews?book=\" + this.$route.query.id)\r\n      .then(res => {\r\n        window.console.log(res);\r\n\r\n        window.console.log(res.data.reviews.slice(0, 2));\r\n        this.pinlun = res.data.reviews.slice(0, 2);\r\n      });\r\n    // 请求相关推荐\r\n    Vue.axios\r\n      .get(\"http://novel.kele8.cn/recommend/\" + this.$route.query.id)\r\n      .then(res => {\r\n        window.console.log(res);\r\n        this.relate = res.data.books.slice(0, 4);\r\n      });\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    // 请求书籍信息\r\n    Vue.axios\r\n      .get(\"http://novel.kele8.cn/book-info/\" + to.query.id)\r\n      .then(response => {\r\n        window.console.log(response);\r\n        next(vm => {\r\n          vm.data = response.data;\r\n        });\r\n      });\r\n  },\r\n  methods: {\r\n    formating(str, kuohao) {\r\n      var miao = str / 1000;\r\n      var fen = miao / 60;\r\n      var xiaoshi = fen / 60;\r\n      if (kuohao) {\r\n        if (xiaoshi >= 1) {\r\n          return \"[\" + parseInt(xiaoshi) + \"小时前更新] \";\r\n        } else if (fen >= 1) {\r\n          return \"[\" + parseInt(fen) + \"分钟前更新] \";\r\n        }\r\n      } else {\r\n        if (xiaoshi >= 1) {\r\n          return parseInt(xiaoshi) + \"小时前更新\";\r\n        } else if (fen >= 1) {\r\n          return parseInt(fen) + \"分钟前更新\";\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.shuxinxi {\r\n  width: 100%;\r\n  padding: 15px;\r\n  position: relative;\r\n  .shuxinxi_wrapper {\r\n    width: 100%;\r\n    &::after {\r\n      content: \"\";\r\n      display: block;\r\n      clear: both;\r\n    }\r\n    .left {\r\n      float: left;\r\n      width: 1.73333rem;\r\n      height: 2.33333rem;\r\n      margin-right: 10px;\r\n      img {\r\n        width: 100%;\r\n        height: 100%;\r\n      }\r\n    }\r\n    .right {\r\n      text-align: left;\r\n      float: left;\r\n      h4 {\r\n        margin: 0;\r\n        padding: 0;\r\n      }\r\n      & > div {\r\n        margin: 2px 0;\r\n        span:nth-child(1) {\r\n          color: #b93321;\r\n        }\r\n        & > span {\r\n          margin-right: 5px;\r\n          font-size: 12px;\r\n          color: #999;\r\n        }\r\n      }\r\n      & > span {\r\n        font-size: 12px;\r\n        color: #999;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// btn\r\n.anniu {\r\n  width: 100%;\r\n  padding: 15px;\r\n  padding-top: 0;\r\n  border-bottom: 1px solid #ebebeb;\r\n  .btn-wrapper {\r\n    width: 100%;\r\n    margin: 0 auto;\r\n    overflow: hidden;\r\n    div {\r\n      width: 45%;\r\n      height: 1.17333rem;\r\n      line-height: 1.17333rem;\r\n    }\r\n    div.left {\r\n      float: left;\r\n      border: 1px solid #b93321;\r\n      color: #b93321;\r\n    }\r\n    div.right {\r\n      float: right;\r\n      color: white;\r\n      background-color: #b93321;\r\n    }\r\n  }\r\n}\r\n\r\n// 人气\r\n.renqi {\r\n  width: 100%;\r\n  padding: 15px 0;\r\n  border-bottom: 1px solid #ebebeb;\r\n  .item {\r\n    width: 33%;\r\n    display: inline-block;\r\n    p {\r\n      color: #999;\r\n      font-size: 12px;\r\n      margin: 0;\r\n      padding: 0;\r\n      margin-bottom: 5px;\r\n    }\r\n    span {\r\n      color: black;\r\n      font-size: 16px;\r\n    }\r\n  }\r\n}\r\n\r\n// juqing\r\n.juqing {\r\n  width: 100%;\r\n  padding: 15px;\r\n  position: relative;\r\n  text-align: left;\r\n  .text {\r\n    width: 100%;\r\n    overflow: hidden;\r\n    display: -webkit-box;\r\n    -webkit-box-orient: vertical;\r\n    -webkit-line-clamp: 3;\r\n    transition: all 0.3s;\r\n  }\r\n  .jiantou {\r\n    width: 0.53333rem;\r\n    height: 0.53333rem;\r\n    position: absolute;\r\n    right: 10px;\r\n    bottom: 15px;\r\n    background-image: url(../assets/xialalist.png);\r\n    background-size: 60% 60%;\r\n    background-position: center center;\r\n    background-repeat: no-repeat;\r\n  }\r\n  &.active {\r\n    .jiantou {\r\n      transform: rotate(180deg);\r\n    }\r\n    .text {\r\n      // display: block;\r\n      -webkit-line-clamp: none;\r\n    }\r\n  }\r\n}\r\n\r\n// 目录\r\n.mulu {\r\n  width: 100%;\r\n  padding-left: 15px;\r\n  border-bottom: 1px solid #ebebeb;\r\n  .mulu-box {\r\n    width: 100%;\r\n    padding: 15px 0;\r\n    border-top: 1px solid #ebebeb;\r\n    text-align: left;\r\n    .right {\r\n      width: 65%;\r\n      float: right;\r\n      margin-right: 9px;\r\n      position: relative;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n      color: #999;\r\n      &::after {\r\n        content: \"\";\r\n        position: absolute;\r\n        right: 0px;\r\n        width: 0.53333rem;\r\n        height: 0.53333rem;\r\n        background-image: url(../assets/xialalist.png);\r\n        background-size: 60% 60%;\r\n        background-position: center;\r\n        background-repeat: no-repeat;\r\n        transform: rotate(270deg);\r\n        margin-left: 10px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 热门书评\r\n.remenshupin {\r\n  width: 100%;\r\n  padding: 15px;\r\n  text-align: left;\r\n  .pinlun {\r\n    width: 100%;\r\n    .title {\r\n      font-size: 16px;\r\n      margin-bottom: 10px;\r\n    }\r\n  }\r\n}\r\n</style>"]}]}